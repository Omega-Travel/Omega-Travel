{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Fido\\\\Documents\\\\GitHub\\\\UI-Design-React\\\\app\\\\screens\\\\PlaceDetail\\\\PlaceImages\\\\UploadImage\\\\index.tsx\";\nimport React, { useRef, useState, useEffect } from 'react';\nimport { Layout } from \"./Layout\";\nimport { useSetNavigationOptions } from \"../../../../hooks/useSetNavigationOptions\";\nimport { Camera } from 'expo-camera';\nimport { useMutation } from '@apollo/react-hooks';\nimport { useRoute } from '@react-navigation/native';\nimport { IMAGE_MUTATION } from \"../../../../utility/mutations/addImage\";\nexport var UploadImage = function UploadImage(_ref) {\n  var navigation = _ref.navigation;\n  useSetNavigationOptions(\"Upload Image\", false);\n  var route = useRoute();\n  var placeId = route.params.placeId;\n\n  var _useMutation = useMutation(IMAGE_MUTATION),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      addImag = _useMutation2[0];\n\n  var camRef = useRef(null);\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      permission = _useState4[0],\n      setPermission = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      hasPermission = _useState6[0],\n      setHasPermission = _useState6[1];\n\n  var _useState7 = useState(Camera.Constants.Type.back),\n      _useState8 = _slicedToArray(_useState7, 2),\n      type = _useState8[0],\n      setType = _useState8[1];\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      capturedPhoto = _useState10[0],\n      setCapturedPhoto = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      open = _useState12[0],\n      setOpen = _useState12[1];\n\n  useEffect(function () {\n    (function _callee() {\n      var _await$Camera$request, status;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(Camera.requestPermissionsAsync());\n\n            case 2:\n              _await$Camera$request = _context.sent;\n              status = _await$Camera$request.status;\n              setPermission(status);\n              setHasPermission(status === 'granted');\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n\n  var takePicture = function takePicture() {\n    var data;\n    return _regeneratorRuntime.async(function takePicture$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (!camRef) {\n              _context2.next = 6;\n              break;\n            }\n\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(camRef.current.takePictureAsync({\n              quality: 0.1,\n              base64: true\n            }));\n\n          case 3:\n            data = _context2.sent;\n            setCapturedPhoto(data);\n            setOpen(true);\n\n          case 6:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var saveHandler = function saveHandler() {\n    var inputData, data;\n    return _regeneratorRuntime.async(function saveHandler$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            setLoading(true);\n            inputData = {\n              placeId: placeId,\n              url: \"data:image/png;base64,\" + capturedPhoto.base64\n            };\n            _context3.next = 4;\n            return _regeneratorRuntime.awrap(addImag({\n              variables: {\n                input: inputData\n              }\n            }).then(function (_ref2) {\n              var data = _ref2.data;\n              return data;\n            }));\n\n          case 4:\n            data = _context3.sent;\n            setLoading(false);\n\n            if (data) {\n              navigation.goBack();\n            }\n\n          case 7:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(Layout, {\n    camRef: camRef,\n    hasPermission: hasPermission,\n    permission: permission,\n    open: open,\n    capturedPhoto: capturedPhoto,\n    type: type,\n    setType: setType,\n    takePicture: takePicture,\n    setOpen: setOpen,\n    saveHandler: saveHandler,\n    loading: loading,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 12\n    }\n  });\n};","map":{"version":3,"sources":["C:/Users/Fido/Documents/GitHub/UI-Design-React/app/screens/PlaceDetail/PlaceImages/UploadImage/index.tsx"],"names":["React","useRef","useState","useEffect","Layout","useSetNavigationOptions","Camera","useMutation","useRoute","IMAGE_MUTATION","UploadImage","navigation","route","placeId","params","addImag","camRef","loading","setLoading","permission","setPermission","hasPermission","setHasPermission","Constants","Type","back","type","setType","capturedPhoto","setCapturedPhoto","open","setOpen","requestPermissionsAsync","status","takePicture","current","takePictureAsync","quality","base64","data","saveHandler","inputData","url","variables","input","then","goBack"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\r\nimport { Layout } from \"./Layout\"\r\nimport { useSetNavigationOptions } from \"../../../../hooks/useSetNavigationOptions\";\r\nimport { Camera } from 'expo-camera';\r\nimport { useMutation } from '@apollo/react-hooks';\r\nimport { useRoute } from '@react-navigation/native';\r\nimport { IMAGE_MUTATION } from '../../../../utility/mutations/addImage';\r\n\r\nexport const UploadImage = ({ navigation }) => {\r\n    useSetNavigationOptions(\"Upload Image\", false);\r\n    const route:any = useRoute();\r\n    const placeId = route.params.placeId;\r\n\r\n    const [addImag] = useMutation(IMAGE_MUTATION);\r\n    \r\n    const camRef = useRef(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const [permission, setPermission] = useState('');\r\n    const [hasPermission, setHasPermission] = useState(false);\r\n    const [type, setType] = useState(Camera.Constants.Type.back);\r\n    const [capturedPhoto, setCapturedPhoto] = useState(null);\r\n    const [open, setOpen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        (async () => {\r\n          const { status } = await Camera.requestPermissionsAsync();\r\n          setPermission(status);\r\n          setHasPermission(status === 'granted');\r\n        })();\r\n      }, []);\r\n\r\n    const takePicture = async () => {\r\n        if(camRef) {\r\n          const data = await camRef.current.takePictureAsync({quality: 0.1, base64: true});\r\n          setCapturedPhoto(data);\r\n          setOpen(true);\r\n        }\r\n    }\r\n\r\n    const saveHandler = async () => {\r\n        setLoading(true);\r\n\r\n        const inputData = {placeId: placeId, url: `data:image/png;base64,${capturedPhoto.base64}` };\r\n        const data = await addImag({\r\n            variables: {\r\n                input: inputData\r\n            },\r\n        }).then(({ data }) => {\r\n            return data;\r\n        });\r\n\r\n        setLoading(false);\r\n        if (data) {\r\n            navigation.goBack();\r\n        }\r\n    }\r\n\r\n    return <Layout \r\n        camRef={camRef} \r\n        hasPermission={hasPermission}\r\n        permission={permission}\r\n        open={open} \r\n        capturedPhoto={capturedPhoto} \r\n        type={type} \r\n        setType={setType} \r\n        takePicture={takePicture} \r\n        setOpen={setOpen}\r\n        saveHandler={saveHandler}\r\n        loading={loading} />\r\n}"]},"metadata":{},"sourceType":"module"}